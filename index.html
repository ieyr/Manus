<!DOCTYPE html>
<html>
	<head>
		<!--Creating global window variable for debugging through console-->
		<script>global=window</script>
		<!--                                                             -->

		<!-- CDNs for visualization -->
		<script src="http://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.7.0/underscore-min.js"></script>
		<script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
		<script src="http://cdnjs.cloudflare.com/ajax/libs/flot/0.8.2/jquery.flot.min.js"></script>
		<!--                        -->

		<!-- Imported scripts -->
		<script type="text/javascript" src='myo.js'></script>
		<script type="text/javascript" src='EMGhandler.js'></script>
		<script type="text/javascript" src='livedata.js'></script>
		<script type="text/javascript" src='util.js'></script>
		<!-- <script type="text/javascript" src='position.js'></script> -->
		<!--                  -->

		<!-- CSS Files -->
		<link rel="stylesheet" type="text/css" href="style.css"></link>


	</head>
	<body>
		<title>EMG Graphs - Myo.js</title>
		<p id="calibration">Move your index finger as far up as possible then hit spacebar.</p>

	</body>

	<script>

		var calibration = []
		var index = 0

		
		$(document).keypress(function(e){
			if(e.keyCode == 114) {	//r is pressed
				if(recording) {
					recording = false
					for(var i = 0; i < 8; i++){
						

						var histArray = $.map(history, function(value, index) {
						    return [value];
						});

						for(key in history){
							histArray.push(history[key])
						}


						var narray = []
						for(var j = 0; j < histArray.length-7; j++){
							narray.push(histArray[j][i])
						}
						console.log('standard deviation for port ' + i + ' on index ' + index + ': '+ calculateStandardDeviation(narray))
						aggregateArray[index].push(calculateStandardDeviation(narray))
					}
					if(index==7){
						console.log(aggregateArray)
						canReceive = true
					}
					
					history = [[]]
					historyIndex = 0
					if(index!=7){
						index++
					}
					getInstruction()
				} else {
					history = [[]]
					historyIndex = 0
					getInstruction()
					recording = true

				}
			}
		})

		function getInstruction(){
			switch(index){

				case 1:
					$('#calibration').text('Move your index finger as far down as possible then hit spacebar.')
					break;
				case 2:
					$('#calibration').text('Move your middle finger as far up as possible then hit spacebar.')
					break;
				case 3:
					$('#calibration').text('Move your middle finger as far down as possible then hit spacebar.')
					break;
				case 4:
					$('#calibration').text('Move your ring finger as far up as possible then hit spacebar.')
					break;
				case 5:
					$('#calibration').text('Move your ring finger as far down as possible then hit spacebar.')
					break;
				case 6:
					$('#calibration').text('Move your pinky finger as far up as possible then hit spacebar.')
					break;
				case 7:
					$('#calibration').text('Move your pinky finger as far down as possible then hit spacebar.')
					break;
				case 8:
					$('#calibration').text('Calibration Complete')
					break;
			}
			
		}



		
	</script>

</html>
